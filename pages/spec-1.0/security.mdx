# Security and Authorization

Security is a critical component of the Open Tool Calling standard.

## Tool Authorization

Tool authorization describes how the server authorizes the tool call: given a tool's definition, whether the client needs to authorize the user before calling the tool.

Tools MAY require token-based or other forms of authorization, as specified in the `requirements.authorization` field of the Tool Definition schema.

When a given tool describes authorization requirements in the `requirements.authorization` field, the client MUST resolve (or delegate to a trusted intermediary) the authorization requirements and provide the necessary credentials (e.g. a token) in the Tool Call Request, before calling the tool.

If the client does not provide a valid token in the Tool Call Request for a tool that requires authorization, the server MUST return a 400 Bad Request response as described in the Tool Execution (Server Errors) section.

### Non-Normative Example: Tool Authorization Flow

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant AS as Authorization Server
    participant S as Tool Server
    participant T as Tool

    U->>C: Input: "Read my recent emails"<br/>user_id: bob@example.com
    Note over C: Tool Gmail.GetEmails has an authorization requirement:<br/>id: google<br/>scopes: [https://www.googleapis.com/auth/gmail.readonly]
    C-->>AS: OAuth 2.0 request
    AS-->>C: Scoped token for user
    C->>S: Call tool Gmail.GetEmails with token
    S->>T: Run tool (function)
    T->>S: Return tool response
    S->>C: Return tool response

```

### Tool Secrets Management

Tool secrets are sensitive information that is required to call a tool, such as API keys, passwords, and other credentials.

Tools MAY require secrets, as specified in the `requirements.secrets` field of the Tool Definition schema.

When a tool requires secrets, the client MUST retrieve the secrets (itself or via a trusted intermediary) and provide them in the Tool Call Request, before calling the tool.

If the client does not provide a secret in the Tool Call Request for a tool that requires a secret, the server MUST return a 400 Bad Request response as described in the Tool Execution (Server Errors) section.

### Non-Normative Example: Tool Secrets Management Flow

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant SM as Secrets Manager
    participant S as Tool Server
    participant T as Tool

    U->>C: Input: "Send an SMS to +15556051234567"<br/>user_id: bob@example.com
    Note over C: Tool SMS.Send has a secret requirement:<br/>id: TWILIO_API_KEY
    C-->>SM: Get secret TWILIO_API_KEY
    SM-->>C: TWILIO_API_KEY=abc123...
    C->>S: Call tool SMS.Send with TWILIO_API_KEY=abc123...
    S->>T: Run tool (function)
    T->>S: Return tool response
    S->>C: Return tool response
```
